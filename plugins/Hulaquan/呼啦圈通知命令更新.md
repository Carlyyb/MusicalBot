# /呼啦圈通知 命令更新说明

## 🎉 更新内容

修改了 `/呼啦圈通知` 命令的行为，现在更加人性化！

---

## 📝 新功能

### 1. 查询当前状态
当你**不带参数**发送命令时，会显示当前的关注状态：

```
发送：/呼啦圈通知
```

**返回示例：**
```
📊 当前呼啦圈通知状态：
当前模式: 模式1 - 🆕 只推送上新/补票

💡 若要设置，请使用：
/呼啦圈通知 <模式编号>

可选模式：
模式0 - ❌ 不接受通知
模式1 - 🆕 只推送上新/补票
模式2 - 🆕🔄 推送上新/补票/回流
模式3 - 🆕🔄📊 推送上新/补票/回流/增减票
```

### 2. 设置新模式（和之前一样）
带参数时设置模式：

```
发送：/呼啦圈通知 1
```

**返回示例：**
```
✅ 已设置为模式1
已关注呼啦圈的上新/补票通知
```

---

## 🆚 对比变化

### 之前的行为
```
/呼啦圈通知          → ❌ 提示"请输入存在的模式"
/呼啦圈通知 1        → ✅ 设置为模式1
```

### 现在的行为
```
/呼啦圈通知          → ✅ 显示当前状态 + 使用说明
/呼啦圈通知 1        → ✅ 设置为模式1（并显示✅图标）
```

---

## 📊 使用场景

### 场景1：查看当前设置
```
用户：我现在是什么模式来着？
操作：/呼啦圈通知
结果：显示当前模式 + 所有可选模式说明
```

### 场景2：切换模式
```
用户：我想改成模式2
操作：/呼啦圈通知 2
结果：✅ 已设置为模式2
      已关注呼啦圈的上新/补票/回流通知
```

### 场景3：群聊设置（需要管理员权限）
```
管理员：/呼啦圈通知          → 显示群聊当前模式
管理员：/呼啦圈通知 2        → 设置群聊模式
普通成员：/呼啦圈通知 2      → ❌ 权限不足提示
```

---

## 🎨 改进点

### 1. 更友好的提示
- ✅ 添加了 emoji 图标（✅ 🆕 🔄 📊 ❌）
- ✅ 明确显示"当前模式"
- ✅ 列出所有可选模式

### 2. 更清晰的引导
- 💡 "若要设置，请使用："提示语
- 📋 列出所有可选模式和说明
- 📊 显示当前状态，方便确认

### 3. 更好的反馈
- 设置成功后显示 ✅ 图标
- 明确显示"已设置为模式X"
- 保留原有的功能说明

---

## 🧪 测试建议

### 测试1：查询状态
```bash
/呼啦圈通知
# 预期：显示当前模式 + 使用说明
```

### 测试2：设置模式1
```bash
/呼啦圈通知 1
# 预期：✅ 已设置为模式1
```

### 测试3：设置模式2
```bash
/呼啦圈通知 2
# 预期：✅ 已设置为模式2
```

### 测试4：查询更新后的状态
```bash
/呼啦圈通知
# 预期：显示新设置的模式
```

### 测试5：无效参数
```bash
/呼啦圈通知 5
# 预期：提示"请输入存在的模式（0-3）"
```

### 测试6：群聊测试（如果适用）
```bash
# 在群聊中
/呼啦圈通知        # 显示群聊当前模式
/呼啦圈通知 2      # 管理员可设置，普通成员提示权限不足
```

---

## 📋 代码变更位置

**文件：** `f:\MusicalBot\plugins\Hulaquan\main.py`

**方法：** `on_switch_scheduled_check_task`

**主要变更：**
1. 添加了"查询当前模式"逻辑
2. 优化了返回消息格式
3. 添加了 emoji 图标
4. 改进了用户引导文案

---

## 🎯 用户体验提升

### 之前
```
用户：/呼啦圈通知
Bot：请输入存在的模式
     用法：/呼啦圈通知 <模式编号>

用户：😕 我都不知道现在是什么模式...
```

### 现在
```
用户：/呼啦圈通知
Bot：📊 当前呼啦圈通知状态：
     当前模式: 模式1 - 🆕 只推送上新/补票
     
     💡 若要设置，请使用：
     /呼啦圈通知 <模式编号>
     
     可选模式：
     模式0 - ❌ 不接受通知
     模式1 - 🆕 只推送上新/补票
     模式2 - 🆕🔄 推送上新/补票/回流
     模式3 - 🆕🔄📊 推送上新/补票/回流/增减票

用户：😊 原来我现在是模式1，我要改成模式2
     /呼啦圈通知 2
```

---

## ✅ 完成！

现在 `/呼啦圈通知` 命令更加智能和友好了！

- ✅ 可以查询当前状态
- ✅ 可以设置新模式
- ✅ 提供清晰的使用说明
- ✅ 保持向后兼容（原有用法不变）
